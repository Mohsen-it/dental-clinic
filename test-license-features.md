# اختبار ميزات الترخيص الجديدة

## الميزات المضافة

### 1. إنشاء تراخيص بالدقائق
- ✅ إضافة خيار `--minutes` لمولد التراخيص
- ✅ دعم الدقائق في الوضع التفاعلي
- ✅ عرض المدة بالدقائق في ملف المعلومات
- ✅ حفظ التراخيص في مجلد بتاريخ اليوم

### 2. حذف الترخيص من الإعدادات
- ✅ إضافة زر حذف الترخيص في قسم إدارة الترخيص
- ✅ تحذير المستخدم قبل الحذف
- ✅ استخدام `licenseManagerRenderer.deactivateLicense()` مباشرة
- ✅ تحديث واجهة المستخدم بعد الحذف

### 3. إصلاح مشكلة إعادة التفعيل
- ✅ إزالة التحقق من وجود ترخيص مفعل في `activateLicense`
- ✅ السماح بإعادة التفعيل عبر حذف الترخيص الموجود تلقائياً
- ✅ إصلاح `resetActivation()` لاستخدام `licenseManagerRenderer`

## أوامر الاختبار

### إنشاء ترخيص بالدقائق
```bash
# ترخيص لـ 2 دقيقة
node license-generator.js --type standard --minutes 2 --output test-2min

# ترخيص لـ 5 دقائق
node license-generator.js --type trial --minutes 5 --output test-5min

# ترخيص لـ 60 دقيقة
node license-generator.js --type premium --minutes 60 --output test-1hour
```

### إنشاء ترخيص بالأيام (للمقارنة)
```bash
# ترخيص لـ 1 يوم
node license-generator.js --type standard --days 1 --output test-1day

# ترخيص لـ 30 يوم
node license-generator.js --type trial --days 30 --output test-30days
```

## خطوات الاختبار

### 1. اختبار إنشاء التراخيص
1. تشغيل الأوامر أعلاه
2. التحقق من إنشاء الملفات في `licenses/2025-06-17/`
3. فحص محتوى ملفات `.info.txt` للتأكد من عرض المدة بالدقائق

### 2. اختبار حذف وإعادة تفعيل الترخيص
1. تشغيل التطبيق: `npm run electron:build`
2. تفعيل ترخيص من الملفات المُنشأة
3. الذهاب إلى الإعدادات > الترخيص
4. الضغط على "حذف الترخيص" والتأكيد
5. التحقق من اختفاء معلومات الترخيص
6. تفعيل ترخيص جديد والتحقق من نجاح العملية

### 3. اختبار انتهاء صلاحية الترخيص بالدقائق
1. تفعيل ترخيص لـ 2 دقيقة
2. انتظار انتهاء الصلاحية
3. التحقق من ظهور رسالة انتهاء الصلاحية
4. اختبار إعادة تفعيل ترخيص جديد

## الملفات المُحدثة

### أدوات التطوير
- `tools/license-generator.js` - إضافة دعم الدقائق
- `license-generator.js` - ملف اختصار لحل مشكلة المسار

### خدمات الترخيص
- `electron/licenseService.js` - إزالة منع إعادة التفعيل
- `src/services/licenseActivationService.ts` - إصلاح `resetActivation()`

### واجهة المستخدم
- `src/pages/Settings.tsx` - إضافة قسم إدارة الترخيص مع زر الحذف

## ملاحظات مهمة

1. **الأمان**: حذف الترخيص يتطلب تأكيد من المستخدم
2. **التوافق**: الميزات الجديدة متوافقة مع التراخيص الموجودة
3. **الاستقرار**: إضافة تأخير زمني قبل تحديث الواجهة لضمان معالجة العمليات
4. **التسجيل**: إضافة رسائل console.log لتسهيل التشخيص

## حالات الاستخدام

### للمطورين
- إنشاء تراخيص قصيرة المدى للاختبار
- اختبار انتهاء الصلاحية بسرعة
- اختبار إعادة التفعيل

### للمستخدمين النهائيين
- حذف الترخيص عند الحاجة لتغييره
- تفعيل ترخيص جديد بدون مشاكل
- واجهة واضحة لإدارة الترخيص
